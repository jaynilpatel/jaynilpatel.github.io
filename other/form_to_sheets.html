<html>

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
    integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous">
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"
    integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous">
  </script>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css"
    integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js"
    integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous">
  </script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@8"></script>
</head>

<body>

  <!-- Button trigger modal -->
  <center>
    <br>
    <button style="font-size: 22px;" type="button" class="btn btn-outline-primary" data-toggle="modal" data-target="#exampleModalCenter">
      Inquiry
    </button>
    <br><br>
    <a href="https://docs.google.com/spreadsheets/d/1lPCvQ-kGK7K8vB7VdiBH8LMLm290VOazwFKstGz9_UE/edit?usp=sharing"
      target="_blank">
      <h5>View Google Sheet</h5>
    </a>
  </center>
  <!-- Modal -->
  <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document" style="max-width: 600px;">
      <div class="modal-content">
        <div class="modal-header" style="background:rgb(2, 114, 235);color:#fff">
          <h5 class="modal-title" id="exampleModalCenterTitle">Admission Inquiry 2019-20</h5>
          <!-- <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true" style="color:#fff;">&times;</span>
          </button> -->
          <button type="button" class="close" onclick="location.href='http://bvmengineering.ac.in/index.aspx';">
            <span aria-hidden="true" style="color:#fff;">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <form name="submit-to-google-sheet" id="form1">
            <!-- <input name="email" type="email" placeholder="Email" required>
            <input type="radio" name="gender" value="male"> Male<br>
            <input type="radio" name="gender" value="female"> Female<br>
            <input type="radio" name="gender" value="other"> Other
            <button type="submit">Send</button> -->
            <div class="input-group mb-3">
              <div class="input-group-prepend">
                <span class="input-group-text" id="name" style="min-width:75px">Name</span>
              </div>
              <input type="text" name="Name" class="form-control" placeholder="Enter Your Name" required>
            </div>
            <div class="input-group mb-3">
              <div class="input-group-prepend">
                <span class="input-group-text" id="email" style="min-width:75px">Email</span>
              </div>
              <input type="email" name="Email" class="form-control" placeholder="Enter Your Email Address" required>
            </div>
            <div class="input-group mb-3">
              <div class="input-group-prepend">
                <span class="input-group-text" id="mobile" style="min-width:75px">Mobile</span>
              </div>
              <input type="tel" minlength="10" maxlength="10" name="Mobile" class="form-control"
                placeholder="Enter 10 digit Mobile No." pattern="[6789][0-9]{9}" required>
            </div>
            <input type="text" style="display:none" name="Interested In" id="interested">

            <table border="0" width="100%">
              <thead>
                <tr>
                  <th colspan="2">Interested In:</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><input type="checkbox" name="branch" value="Civil"> Civil</td>
                  <td><input type="checkbox" name="branch" value="Mechanical"> Mechanical</td>
                </tr>
                <tr>
                  <td><input type="checkbox" name="branch" value="Production"> Production</td>
                  <td><input type="checkbox" name="branch" value="Electronics & Comm."> Electronics & Comm.
                  </td>
                </tr>
                <tr>
                  <td><input type="checkbox" name="branch" value="Computer"> Computer</td>
                  <td><input type="checkbox" name="branch" value="Information Technology"> Information
                    Technology
                  </td>
                </tr>
                <tr>
                  <td><input type="checkbox" name="branch" value="Electrical"> Electrical</td>
                  <td><input type="checkbox" name="branch" value="Electronics"> Electronics</td>
                </tr>
                <tr>
                  <td id="branchErr" style="display:none;color:crimson;font-size: 12px;" colspan="2">*Select alteast one branch
                  </td>
                </tr>
              </tbody>
            </table><br>
            <span><input type="checkbox" id="consent"> I do not have any objection to receive call from BVM
              Engineering College</span>
            <span id="consentErr" style="color:crimson; display:none;font-size: 12px;">*Please check the above box to
              proceed</span>
          </form>
        </div>
        <div class="modal-footer" style="padding:0.5rem;justify-content:center">
          <button type="button" id="closeModalBtn" class="btn btn-secondary" data-dismiss="modal"
            style="display: none">Close</button>
          <button type="submit" id="submitBtn" form="form1" class="btn btn-primary">Submit</button>
        </div>
        <div class="modal-footer" style="justify-content:space-between">
          <span style="font-size:12px;  display: flex">Call : 02692-230-104</span><span
            style="font-size:12px; display: flex">Email : principal@bvmengineering.ac.in
          </span>
        </div>
      </div>
    </div>
  </div>
  <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbw_hThPV1-MnB5rT0ubfQf6G4JTX2nwoIBVxLT7SDkrZmkrS3E/exec'
    const form = document.forms['submit-to-google-sheet']

    form.addEventListener('submit', e => {
      e.preventDefault();
      var interests = [];
      $.each($("input[name='branch']:checked"), function () {
        interests.push($(this).val());
      });
      var interested = interests.join(", ")
      validation = true;
      if (interested.length == 0) {
        validation = false;
        $("#branchErr").css("display", "inline-block");
      }else{
        $("#branchErr").css("display", "none");
      }
      if ($("#consent").prop("checked") == false) {
        validation = false;
        $("#consentErr").css("display", "inline-block");
      }else{
        $("#consentErr").css("display", "none");
      }
      //console.log("Interested:", interested)
      $("#interested").val(interested);
      if (validation === true) {
        $("#closeModalBtn").click();
        fetch(scriptURL, {
            method: 'POST',
            body: new FormData(form)
          })
          .then(Swal.fire({
            type: 'success',
            title: 'Saved',
            text: 'You will be contact soon...',
          }).then(() => {
            document.getElementById("form1").reset();
            $.each($("input[type='checkbox']:checked"), function () {
              $(this).prop('checked', false);
            });
            $("#branchErr").css("display", "none");
            //window.location.href = "http://www.bvmengineering.ac.in/index.aspx";
          }))
          .catch(error => console.error('Error!', error.message))
      }
    })
  </script>
</body>

</html>